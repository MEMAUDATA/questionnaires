<!DOCTYPE html>
<html lang="fr">
  <head>
    <!-- Author's details-->
        <meta name="author" content="Nicolas Vannson">
        <meta name="contact" content="hello@memau.eu">
        <meta name="license" content="EUPLv1.2">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.0/jspdf.umd.min.js"></script>
        <script src= https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
        <link rel="stylesheet" href="/style.css">
        <style>
          /* style is within the style.css sheet */
        </style>
    <title>MASH</title>
  </head>
  <body>

    <h1>Multiple-Activity Scale for Hyperacusis (M.A.S.H.)</h1>
    <p>Dauman & Bouscau-Faure, 2005 (originale)<br>
      Jalabert et al., 2021 (questions identiques sous un nouveau format non publié)</p>
    <br>

    <form id="MASH">
      <table>
        <thead>
          <tr>
            <th>Activité / Situation</th>
            <th>Activités évitées ou modifiées <br>(0 = Jamais, 10 = Toujours)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="Question_MASH">1. Concerts, boîtes de nuit, spectacles</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q1" value="0">0</label>
                <label><input type="radio" name="q1" value="1">1</label>
                <label><input type="radio" name="q1" value="2">2</label>
                <label><input type="radio" name="q1" value="3">3</label>
                <label><input type="radio" name="q1" value="4">4</label>
                <label><input type="radio" name="q1" value="5">5</label>
                <label><input type="radio" name="q1" value="6">6</label>
                <label><input type="radio" name="q1" value="7">7</label>
                <label><input type="radio" name="q1" value="8">8</label>
                <label><input type="radio" name="q1" value="9">9</label>
                <label><input type="radio" name="q1" value="10">10</label>
              </div>
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">2. Courses (supermarchés, centres commerciaux)</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q2" value="0">0</label>
                <label><input type="radio" name="q2" value="1">1</label>
                <label><input type="radio" name="q2" value="2">2</label>
                <label><input type="radio" name="q2" value="3">3</label>
                <label><input type="radio" name="q2" value="4">4</label>
                <label><input type="radio" name="q2" value="5">5</label>
                <label><input type="radio" name="q2" value="6">6</label>
                <label><input type="radio" name="q2" value="7">7</label>
                <label><input type="radio" name="q2" value="8">8</label>
                <label><input type="radio" name="q2" value="9">9</label>
                <label><input type="radio" name="q2" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">3. Cinéma/Télévision</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q3" value="0">0</label>
                <label><input type="radio" name="q3" value="1">1</label>
                <label><input type="radio" name="q3" value="2">2</label>
                <label><input type="radio" name="q3" value="3">3</label>
                <label><input type="radio" name="q3" value="4">4</label>
                <label><input type="radio" name="q3" value="5">5</label>
                <label><input type="radio" name="q3" value="6">6</label>
                <label><input type="radio" name="q3" value="7">7</label>
                <label><input type="radio" name="q3" value="8">8</label>
                <label><input type="radio" name="q3" value="9">9</label>
                <label><input type="radio" name="q3" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">4. Travail/Études</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q4" value="0">0</label>
                <label><input type="radio" name="q4" value="1">1</label>
                <label><input type="radio" name="q4" value="2">2</label>
                <label><input type="radio" name="q4" value="3">3</label>
                <label><input type="radio" name="q4" value="4">4</label>
                <label><input type="radio" name="q4" value="5">5</label>
                <label><input type="radio" name="q4" value="6">6</label>
                <label><input type="radio" name="q4" value="7">7</label>
                <label><input type="radio" name="q4" value="8">8</label>
                <label><input type="radio" name="q4" value="9">9</label>
                <label><input type="radio" name="q4" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">5. Restaurant / Café</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q5" value="0">0</label>
                <label><input type="radio" name="q5" value="1">1</label>
                <label><input type="radio" name="q5" value="2">2</label>
                <label><input type="radio" name="q5" value="3">3</label>
                <label><input type="radio" name="q5" value="4">4</label>
                <label><input type="radio" name="q5" value="5">5</label>
                <label><input type="radio" name="q5" value="6">6</label>
                <label><input type="radio" name="q5" value="7">7</label>
                <label><input type="radio" name="q5" value="8">8</label>
                <label><input type="radio" name="q5" value="9">9</label>
                <label><input type="radio" name="q5" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">6. Conduite (voiture, moto)</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q6" value="0">0</label>
                <label><input type="radio" name="q6" value="1">1</label>
                <label><input type="radio" name="q6" value="2">2</label>
                <label><input type="radio" name="q6" value="3">3</label>
                <label><input type="radio" name="q6" value="4">4</label>
                <label><input type="radio" name="q6" value="5">5</label>
                <label><input type="radio" name="q6" value="6">6</label>
                <label><input type="radio" name="q6" value="7">7</label>
                <label><input type="radio" name="q6" value="8">8</label>
                <label><input type="radio" name="q6" value="9">9</label>
                <label><input type="radio" name="q6" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">7. Sport / Activités physiques (gymnase, piscine)</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q7" value="0">0</label>
                <label><input type="radio" name="q7" value="1">1</label>
                <label><input type="radio" name="q7" value="2">2</label>
                <label><input type="radio" name="q7" value="3">3</label>
                <label><input type="radio" name="q7" value="4">4</label>
                <label><input type="radio" name="q7" value="5">5</label>
                <label><input type="radio" name="q7" value="6">6</label>
                <label><input type="radio" name="q7" value="7">7</label>
                <label><input type="radio" name="q7" value="8">8</label>
                <label><input type="radio" name="q7" value="9">9</label>
                <label><input type="radio" name="q7" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">8. Lieux de culte / Réunions calmes</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q8" value="0">0</label>
                <label><input type="radio" name="q8" value="1">1</label>
                <label><input type="radio" name="q8" value="2">2</label>
                <label><input type="radio" name="q8" value="3">3</label>
                <label><input type="radio" name="q8" value="4">4</label>
                <label><input type="radio" name="q8" value="5">5</label>
                <label><input type="radio" name="q8" value="6">6</label>
                <label><input type="radio" name="q8" value="7">7</label>
                <label><input type="radio" name="q8" value="8">8</label>
                <label><input type="radio" name="q8" value="9">9</label>
                <label><input type="radio" name="q8" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">9. Ménage / Utilisation d'appareils électroménagers</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q9" value="0">0</label>
                <label><input type="radio" name="q9" value="1">1</label>
                <label><input type="radio" name="q9" value="2">2</label>
                <label><input type="radio" name="q9" value="3">3</label>
                <label><input type="radio" name="q9" value="4">4</label>
                <label><input type="radio" name="q9" value="5">5</label>
                <label><input type="radio" name="q9" value="6">6</label>
                <label><input type="radio" name="q9" value="7">7</label>
                <label><input type="radio" name="q9" value="8">8</label>
                <label><input type="radio" name="q9" value="9">9</label>
                <label><input type="radio" name="q9" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">10. Enfants (cris, jeux, activités bruyantes)</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q10" value="0">0</label>
                <label><input type="radio" name="q10" value="1">1</label>
                <label><input type="radio" name="q10" value="2">2</label>
                <label><input type="radio" name="q10" value="3">3</label>
                <label><input type="radio" name="q10" value="4">4</label>
                <label><input type="radio" name="q10" value="5">5</label>
                <label><input type="radio" name="q10" value="6">6</label>
                <label><input type="radio" name="q10" value="7">7</label>
                <label><input type="radio" name="q10" value="8">8</label>
                <label><input type="radio" name="q10" value="9">9</label>
                <label><input type="radio" name="q10" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">11. Situations sociales / Conversations de groupe</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q11" value="0">0</label>
                <label><input type="radio" name="q11" value="1">1</label>
                <label><input type="radio" name="q11" value="2">2</label>
                <label><input type="radio" name="q11" value="3">3</label>
                <label><input type="radio" name="q11" value="4">4</label>
                <label><input type="radio" name="q11" value="5">5</label>
                <label><input type="radio" name="q11" value="6">6</label>
                <label><input type="radio" name="q11" value="7">7</label>
                <label><input type="radio" name="q11" value="8">8</label>
                <label><input type="radio" name="q11" value="9">9</label>
                <label><input type="radio" name="q11" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">12. Bricolage / Utilisation d'outils bruyants</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q12" value="0">0</label>
                <label><input type="radio" name="q12" value="1">1</label>
                <label><input type="radio" name="q12" value="2">2</label>
                <label><input type="radio" name="q12" value="3">3</label>
                <label><input type="radio" name="q12" value="4">4</label>
                <label><input type="radio" name="q12" value="5">5</label>
                <label><input type="radio" name="q12" value="6">6</label>
                <label><input type="radio" name="q12" value="7">7</label>
                <label><input type="radio" name="q12" value="8">8</label>
                <label><input type="radio" name="q12" value="9">9</label>
                <label><input type="radio" name="q12" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">13. Jardinage / Tondeuse à gazon</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q13" value="0">0</label>
                <label><input type="radio" name="q13" value="1">1</label>
                <label><input type="radio" name="q13" value="2">2</label>
                <label><input type="radio" name="q13" value="3">3</label>
                <label><input type="radio" name="q13" value="4">4</label>
                <label><input type="radio" name="q13" value="5">5</label>
                <label><input type="radio" name="q13" value="6">6</label>
                <label><input type="radio" name="q13" value="7">7</label>
                <label><input type="radio" name="q13" value="8">8</label>
                <label><input type="radio" name="q13" value="9">9</label>
                <label><input type="radio" name="q13" value="10">10</label>
              </div> 
            </td>
          </tr>
          <tr>
            <td class="Question_MASH">14. Autre situation spécifique non listée</td>
            <td>
              <div class="MASH_scale">
                <label><input type="radio" name="q14" value="0">0</label>
                <label><input type="radio" name="q14" value="1">1</label>
                <label><input type="radio" name="q14" value="2">2</label>
                <label><input type="radio" name="q14" value="3">3</label>
                <label><input type="radio" name="q14" value="4">4</label>
                <label><input type="radio" name="q14" value="5">5</label>
                <label><input type="radio" name="q14" value="6">6</label>
                <label><input type="radio" name="q14" value="7">7</label>
                <label><input type="radio" name="q14" value="8">8</label>
                <label><input type="radio" name="q14" value="9">9</label>
                <label><input type="radio" name="q14" value="10">10</label>
              </div> 
            </td>
          </tr>
        </tbody>
      </table>
      <div class="buttons-container">
        <button type="button" onclick="calculateScore()">Calculer le score</button>
        <button type="reset" onclick="resetForm()">Réinitialiser</button>
      </div>
    </form>

    <div id="results" style="display:none">
        <p id="scoreDisplay"></p><br>
        <label for="nameID" class="Subject_name">Nom du sujet (si besoin)</label>
        <input type="text" id="ID" name="nameID"><br>
        <button id="savePdfButton" onclick="savePdf()">Exporter en PDF</button>
        <button id="saveXLSbutton" onclick="saveXLS()">Exporter en XLS</button>
      </div>
    <script>

      function calculateScore() {

        let total = 0;
        let allAnswered = true; 
        for (let i = 1; i <= 14; i++) {
          let question= document.querySelector(`input[name="q${i}"]:checked`);
          if (!question) { 
            allAnswered = false;
            break; 
          }
          total += parseInt(question.value);
        } // enf for loop
        
        if (allAnswered) {
          total = total /14;
          displayscores(total); 
        } else {
          // Display a message to the user that not all questions have been answered
          const resultDiv = document.getElementById("results"); // Assuming you have a div with id="result"
          resultDiv.innerHTML = "<p class=Error_message_not_all_answered>Veuillez répondre svp à toutes les questions avant de calculer le score!</p>";
          resultDiv.style.display = "block"; // Make sure the result div is visible
        }

      } // end calculateScore function
        
      function displayscores(total) {
        let displayHtml = "<p'>Résultat</p>";
        displayHtml += "<p>Le score global : " + total.toFixed(2) + " /10 </p>";
        if (total >= 0 && total < 3) {
          displayHtml += "Cela indique une hyperacousie faible : score entre 0 et 3";
        } else if (total >= 3 && total <5) {
          displayHtml += "Cela indique une hyperacousie modérée : score entre 3 et 5";
        } else if (total >= 5 && total < 7) {
          displayHtml += "Cela indique une hyperacousie substantielle : score entre  5 et 7";
        }
        else if (total >7) {
          displayHtml += " Cela indique une hyperacousie sévère : score > à 7";
        }
        document.getElementById("results").innerHTML = displayHtml;
        document.getElementById("results").style.display = "block";
      } // end display function

      function resetForm() {
        document.getElementById("MASH").reset();
        document.getElementById("results").innerHTML = "";
        document.getElementById("results").style.display = "none";
      } // end resetForm function
    </script>
  </body>
</html>