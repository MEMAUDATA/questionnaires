<!DOCTYPE html>
<html lang="fr">
  <head>
    <!-- Author's details-->
    <meta name="author" content="Nicolas Vannson">
    <meta name="contact" content="hello@memau.eu">
    <meta name="license" content="EUPLv1.2">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="/style.css">
    <style>
      /* style is within the style.css sheet */
    </style>
    <title>15iSSQ</title>
  </head>

  <body>
    <h1>Questionnaire d'habilités auditives 15iSSQ</h1>
    <h2>(parole, audition spatiale et qualité de l'audition)</h2>
    <br>
    <p> Gatehouse & Noble, 2004 (version originale à 49 items)<br>
      Moulin et al., 2015 (création du 15iSSQ en français)<br>
      Moulin et al., 2019 (validation du 15iSSQ en français) </p>
    <p><i> Questionnaire sous licence CC BY-NC-SA 4.0 </i></p>
    <p><b>Conseil pour répondre aux questions</b></p>
    <p class="Consignes_SSQ">Les questions suivantes concernent votre capacité et votre expérience en matière d’audition et d’écoute dans le cadre de
      situations diverses.<br>
      Déplacez le curseur (ou slider) situé à droite de chacune des questions, à l’endroit adéquat entre le 0 et le 10. Si le curseur se trouve au niveau de la valeur 10, cela signifie que vous êtes parfaitement capable de faire ou d’expérimenter ce qui est décrit dans la question correspondante. Si le curseur se trouve sur le 0, cela indique que vous n’êtes pratiquement pas en mesure de faire
      ni d’expérimenter ce qui est décrit.<br>
    <p style="text-align: left;"><b>Exemple</b></p> 
    <form id="DEMO">   
      <table>
        <thead>
        </thead>
        <tbody>
          <tr>
            <td class="Question_SSQ">
              0. Vous pouvez suivre une conversation avec une personne en face de vous, dans le calme ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Non, pas du tout</span>
                <span>Oui, parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q1">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q1_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>

        </tbody>
      </table>
    </form>
    <p class="Consignes_SSQ"> La question 0 se rapporte à votre capacité de suivre une conversation. Si vous êtes tout à fait capable de le faire, placez le curseur sur l’extrémité droite de l’échelle. Si vous êtes capable de suivre environ
      la moitié de la conversation dans une telle situation, placez le curseur  vers le milieu de l’échelle et ainsi de suite. <br>
      Nous espérons que toutes les questions sont pertinentes au regard de votre vie quotidienne. Si ce n’est pas le cas
      pour certaines questions, veuillez cocher la case « non applicable » (NA).</p>
    <br>

    <form id="15iSSQ">

      <h3 class="Question_SSQ"> 1ère partie : Audition de la parole </h3>

      <table>
        <thead>
        </thead>
        <tbody>
          <tr>
            <td class="Question_SSQ">
              1. Vous discutez avec une autre personne dans une pièce dans laquelle un téléviseur est allumé. Pouvez-vous suivre les propos de votre interlocuteur sans baisser le son du
              téléviseur ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q1">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q1_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              2. Vous êtes assis autour d’une table avec un groupe de cinq personnes environ, dans un restaurant animé. Vous pouvez voir toutes les personnes du groupe. Pouvez-vous suivre la
              conversation ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q2">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q2_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              3. Vous discutez avec une autre personne. Il y a un bruit de fond continu (ventilateur ou eau qui coule par exemple). Pouvez-vous suivre ce que dit l’autre personne ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q3">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q3_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              4. Vous êtes assis autour d’une table avec un groupe de cinq personnes environ, dans un restaurant animé. Vous NE pouvez PAS voir toutes les personnes du groupe. Pouvez-vous suivre la conversation ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q4">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q4_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              5. Vous discutez avec quelqu’un dans une pièce dans laquelle beaucoup d’autres
              personnes s’entretiennent. Pouvez-vous suivre ce que vous dit votre interlocuteur ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q5">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q5_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
        </tbody>
      </table>

      <h3 class="Question_SSQ"> 2e partie : Audition spatiale </h3>

      <table>
        <thead>
        </thead>
        <tbody>
          <tr>
            <td class="Question_SSQ">
              6. Vous êtes assis autour d’une table ou participez à une réunion avec plusieurs
              personnes. Vous ne pouvez pas voir toutes les personnes. Pouvez-vous dire où se trouvent
              les différentes personnes dès qu’elles prennent la parole ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q6">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q6_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              7. Vous êtes à l’extérieur. Un chien aboie bruyamment. Pouvez-vous indiquer
              immédiatement où il se trouve, sans regarder ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q7">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q7_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              8. Vous êtes sur le trottoir d’une rue animée. Pouvez-vous entendre immédiatement de
              quelle direction un bus ou un camion arrive avant de l’avoir vu ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q8">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q8_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              9. Pouvez-vous indiquer dans quelle direction une personne se déplace, uniquement au son de sa voix ou de ses pas, par exemple de votre gauche à votre droite ou inversement ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q9">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q9_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              10. Avez-vous l’impression de pouvoir déterminer avec précision d’où proviennent
              les bruits que vous entendez ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q10">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q10_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
        </tbody>
      </table>

      <h3 class="Question_SSQ"> 3e partie : Qualité d’audition </h3>

      <table>
        <thead>
        </thead>
        <tbody>
          <tr>
            <td class="Question_SSQ">
              11. Pouvez-vous reconnaître facilement les différentes personnes que vous connaissez au son de leur voix ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q11">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q11_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              12. Pouvez-vous distinguer facilement les différents morceaux de musique que vous
              connaissez ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q12">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q12_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              13. Pouvez-vous différencier certains bruits, par exemple une voiture par rapport à un bus ou de l’eau qui bout par rapport à la nourriture qui frit dans une poêle ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q13">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q13_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>

          <tr>
            <td class="Question_SSQ">
              14. Lorsque vous écoutez de la musique, est-ce qu’elle retentit de manière distincte et naturelle ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q14">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q14_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>

          <tr>
            <td class="Question_SSQ">
              15. Les bruits quotidiens que vous entendez facilement sont-ils distincts (non brouillés) ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q15">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q15_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>

        </tbody>
      </table>

      <div class="buttons-container">
        <button type="button" onclick="calculerScores()">Calculer les scores</button>
        <button type="reset" onclick="resetForm()">Réinitialiser</button>
      </div>

    </form>

    <div id="results"></div>

    <script>

      // Sliders colors
      const sliders = document.querySelectorAll(".slider");
      sliders.forEach(function(slider) {
        slider.addEventListener("input", function () {
          const value = (this.value - this.min) / (this.max - this.min) * 100;
          this.style.background = `linear-gradient(to right, #2B176C ${value}%,  #eeeeee ${value}%)`;
        });

        // Appliquer le dégradé à l’état initial
        const initialValue = (slider.value - slider.min) / (slider.max - slider.min) * 100;
        slider.style.background = `linear-gradient(to right, #2B176C ${initialValue}%, #eeeeee ${initialValue}%)`;
      });

      function calculerScores() {
        let total     	= 0;
        let parole    	= 0;
        let spatial 	= 0;
        let qualite 	= 0;

        let count_Na_total      = 0;
        let count_Na_parole    	= 0;
        let count_Na_spatial    = 0;
        let count_Na_qualite    = 0


        // Slider and Na id
        const sliderIds = ["q1", "q2", "q3", "q4", "q5", "q6", "q7", "q8", "q9", "q10", "q11", "q12","q13","q14","q15"];
        const naCheckboxIds = ["q1_na", "q2_na", "q3_na", "q4_na", "q5_na", "q6_na", "q7_na", "q8_na", "q9_na", "q10_na", "q11_na", "q12_na","q13_na","q14_na","q15_na"];



        // Boucle total
        for (let i = 0; i < sliderIds.length; i++) {
          const sliderId = sliderIds[i];
          const naCheckboxId = naCheckboxIds[i];
          const slider = document.getElementById(sliderId);
          const naCheckbox = document.getElementById(naCheckboxId);
          if (naCheckbox.checked) {
            count_Na_total++;
          } else {
            total += parseFloat(slider.value, 10);
          }
        } // end total loop


        // Boucle parole
        for (let i = 0; i < 5; i++) {
          const slider = document.getElementById(sliderIds[i]);
          const naCheckbox = document.getElementById(naCheckboxIds[i]);
          if (naCheckbox.checked) {
            count_Na_parole++;
          } else {
            parole += parseFloat(slider.value, 10);
          }
        } // end parole loop


        // Boucle spatial
        for (let i = 5; i < 10; i++) {
          const slider = document.getElementById(sliderIds[i]);
          const naCheckbox = document.getElementById(naCheckboxIds[i]);
          if (naCheckbox.checked) {
            count_Na_spatial++;
          } else {
            spatial += parseFloat(slider.value, 10);
          }
        } // end spatial loop


        // Boucle qualite
        for (let i = 10; i < 15; i++) {
          const slider = document.getElementById(sliderIds[i]);
          const naCheckbox = document.getElementById(naCheckboxIds[i]);
          if (naCheckbox.checked) {
            count_Na_qualite++;
          } else {
            qualite += parseFloat(slider.value, 10);
          }
        } // end qualite loop


        // Compute average scores
        if (count_Na_total === sliderIds.length) {
          total = parole = spatial = qualite = NaN;
        }
        else {
          total   = total   / (sliderIds.length - count_Na_total);
          parole  = parole  / (5 - count_Na_parole);
          spatial = spatial / (5 - count_Na_spatial);
          qualite = qualite / (5 - count_Na_qualite);
        }

        displayscores(total, parole, spatial,qualite);

      } // end calculerScores function


      function displayscores(total, parole, spatial, qualite) {
        let display = ""; 

        if (isNaN(total)) {
          display += "<p>Score incalculable : toutes les cases Non applicable ont été cochées.</p>";
        } else {
          display += "<p>Résultats</p><br>";
          display += "<ul class='myList'>";
          display += "<li>Score total : " + total.toFixed(2) + "</li>";
          display += "<li>Audition de la parole : " + parole.toFixed(2) + "</li>";
          display += "<li>Audition spatiale : " + spatial.toFixed(2) + "</li>";
          display += "<li>Qualité d’audition : " + qualite.toFixed(2) + "</li>";
          display += "</ul>";
        }

        document.getElementById("results").innerHTML = display;
        document.getElementById("results").style.display = "block";
      }


      function resetForm() {
        document.getElementById("DEMO").reset();
        document.getElementById("15iSSQ").reset();
        document.getElementById("results").innerHTML = "";
        document.getElementById('results').style.display = 'none';

        // Réinitialise le fond des sliders
        const sliders = document.querySelectorAll(".slider");
        sliders.forEach(function (slider) {
        const initialValue = (slider.value - slider.min) / (slider.max - slider.min) * 100;
        slider.style.background = `linear-gradient(to right, #2B176C ${initialValue}%, #eeeeee ${initialValue}%)`;
      });


      } // end function
    </script>
  </body>

</html>
