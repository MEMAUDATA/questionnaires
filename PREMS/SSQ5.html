<!DOCTYPE html>
<html lang="fr">
  <head>
    <!-- Author's details-->
    <meta name="author" content="Nicolas Vannson">
    <meta name="contact" content="hello@memau.eu">
    <meta name="license" content="EUPLv1.2">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="/style.css">
    <style>
      /* style is within the style.css sheet */
    </style>
    <title>SSQ5</title>
  </head>

  <body>
    <h1>SSQ5</h1>
    <p> Gatehouse & Noble,2004 (version originale à 49 items)<br>
    Moulin et Richard, 2016 (version simplifiée et validée en français)<p>
    <p><b>Conseil pour répondre aux questions</b></p>
    <p class="Consignes_SSQ">Les questions suivantes concernent votre capacité et votre expérience en matière d’audition et d’écoute dans le cadre de
      situations diverses.<br>
      Déplacez le curseur (ou slider) situé à droite de chacune des questions, à l’endroit adéquat entre le 0 et le 10. Si le curseur se trouve au niveau de la valeur 10, cela signifie que vous êtes parfaitement capable de faire ou d’expérimenter ce qui est décrit dans la question correspondante. Si le curseur se trouve sur le 0, cela indique que vous n’êtes pratiquement pas en mesure de faire
      ni d’expérimenter ce qui est décrit.<br>
    <p style="text-align: left;"><b>Exemple</b></p> 
    <form id="DEMO">   
      <table>
        <thead>
        </thead>
        <tbody>
          <tr>
            <td class="Question_SSQ">
              0. Vous pouvez suivre une conversation avec une personne en face de vous, dans le calme ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Non, pas du tout</span>
                <span>Oui, parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q1">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>
            <td class="na-checkbox">
              <input type="checkbox" id="q1_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>

        </tbody>
      </table>
    </form>
    <p class="Consignes_SSQ"> La question 0 se rapporte à votre capacité de suivre une conversation. Si vous êtes tout à fait capable de le faire, placez le curseur sur l’extrémité droite de l’échelle. Si vous êtes capable de suivre environ
      la moitié de la conversation dans une telle situation, placez le curseur  vers le milieu de l’échelle et ainsi de suite. <br>
      Nous espérons que toutes les questions sont pertinentes au regard de votre vie quotidienne. Si ce n’est pas le cas
      pour certaines questions, veuillez cocher la case « non applicable » (NA).</p>
    <br>
    <br>
    <form id="SSQ5">
      <table>
        <thead>
        </thead>
        <tbody>
          <tr>
            <td class="Question_SSQ">
                1. Pouvez-vous avoir une conversation avec une personne si une autre personne ayant la voix aussi aigue ou grave
                que celle de votre interlocuteur parle en même temps ?
            </td>
            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q1">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>

            <td class="na-checkbox">
              <input type="checkbox" id="q1_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>

          <tr>
            <td class="Question_SSQ">
              2. Vous êtes assis entre deux personnes. L’une d’elles commence à parler. Pouvez-vous dire immédiatement sans
              regarder s’il s’agit de la personne assise à votre gauche ou à votre droite ?
            </td>

            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q2">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>

            <td class="na-checkbox">
              <input type="checkbox" id="q2_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
          <tr>
            <td class="Question_SSQ">
              3. Pouvez-vous indiquer immédiatement à quelle distance se trouve un bus ou un camion, juste en entendant le
              bruit qu’il fait ?
            </td>

            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q3">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>

            <td class="na-checkbox">
              <input type="checkbox" id="q3_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>

          <tr>
            <td class="Question_SSQ">
              4. Les bruits quotidiens que vous entendez facilement sont-ils distincts (non brouillés)?
            </td>

            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Pas du tout</span>
                <span>Parfaitement</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q4">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>

            <td class="na-checkbox">
              <input type="checkbox" id="q4_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>

          <tr>
            <td class="Question_SSQ">
              5. Devez-vous vous concentrer intensément lorsque vous écoutez quelqu’un ou quelque chose ?
            </td>

            <td class="Question_SSQ">
              <div class="SSQ_answer">
                <span>Concentration intense</span>
                <span>Pas de concentration</span>
              </div>
              <input type="range" min="0" max="10" step="0.1" value="5" class="slider" id="q5">
              <div class="SSQ_answer">
                <span>0</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span>9</span>
                <span>10</span>
              </div>
            </td>

            <td class="na-checkbox">
              <input type="checkbox" id="q5_na">
              <span style="float: right;">Non appliquable</span>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="buttons-container ">
        <button type="button" onclick="calculerScores()">Calculer les scores</button>
        <button type="reset" onclick="resetForm()">Réinitialiser</button>
      </div>

    </form>

    <div id="results"></div>

    <script>

      // Sliders colors
      const sliders = document.querySelectorAll(".slider");
      sliders.forEach(function(slider) {
      slider.addEventListener("input", function () {
      const value = (this.value - this.min) / (this.max - this.min) * 100;
      this.style.background = `linear-gradient(to right, #2B176C ${value}%,  #eeeeee ${value}%)`;
      });

      // Appliquer le dégradé à l’état initial
      const initialValue = (slider.value - slider.min) / (slider.max - slider.min) * 100;
      slider.style.background = `linear-gradient(to right, #2B176C ${initialValue}%, #eeeeee ${initialValue}%)`;
    });

      function calculerScores() {
        let score = 0;
        let countNa = 0;

        // Slider and Na id
        const sliderIds = ["q1", "q2", "q3", "q4", "q5"];
        const naCheckboxIds = ["q1_na", "q2_na", "q3_na", "q4_na", "q5_na"];


        // Loop
        for (let i = 0; i < sliderIds.length; i++) {
          const slider = document.getElementById(sliderIds[i]);
          const naCheckbox = document.getElementById(naCheckboxIds[i]);

          if (naCheckbox.checked) {
            countNa++; // Increment countNa, not add countNa to itself
          } else {
            score += parseFloat(slider.value, 10);
          }
        } // end loop

        if (countNa === sliderIds.length) {
            score = NaN;
            displayscores(score);
        } else {
          score = score / (sliderIds.length - countNa);
          displayscores(score);
        }
      } // end function

      function displayscores(score) {
      const results = document.getElementById("results");
      if (isNaN(score)) {
        results.textContent = "Score incalculable : toutes les cases Non applicable ont été cochées.";
      } else {
        results.textContent = "Le score total est " + score.toFixed(2);
      }
      results.style.display = "block";
    }// end function
      function resetForm() {
        document.getElementById("DEMO").reset();
        document.getElementById("SSQ5").reset();
        document.getElementById("results").innerHTML = "";
        document.getElementById('results').style.display = 'none';

      // Réinitialise le fond des sliders
      const sliders = document.querySelectorAll(".slider");
      sliders.forEach(function (slider) {
        const initialValue = (slider.value - slider.min) / (slider.max - slider.min) * 100;
        slider.style.background = `linear-gradient(to right, #2B176C ${initialValue}%, #eeeeee ${initialValue}%)`;
      });

      } // end function
    </script>
  </body>

</html>
