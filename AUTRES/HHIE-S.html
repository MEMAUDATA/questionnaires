<!DOCTYPE html>
<html lang="fr">
  <head>
   <!-- Author's details-->
   <meta name="author" content="Nicolas Vannson">
   <meta name="contact" content="hello@memau.eu">
   <meta name="license" content="EUPLv1.2">
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.0/jspdf.umd.min.js"></script>
   <script src= https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js ></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
   <link rel="stylesheet" href="/style.css">
   <style>
     /* style is within the style.css sheet */
   </style>
    <title>HHIE-S</title>
  </head>
  <body>

      <h1>Hearing Handicap Inventory for the Elderly-Screening (HHIE-S)</h1>
      <p>Duchêne et al., 2022</p>
      <br>
      <form id="HHIE-S">
        <table>
          <thead>
          </thead>
          <tbody>
            <tr>
              <td class="Question_HHIES">Vous sentez-vous mal à l’aiseà cause d’un problème d’audition lorsque vous rencontrez de nouvelles
                personnes ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q1" value="oui"> oui</label>
                  <label><input type="radio" name="q1" value="parfois"> parfois</label>
                  <label><input type="radio" name="q1" value="non"> non</label>
                </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Vous sentez-vous frustré(e) par un problème d’audition lorsque vous parlez aux membres de votre famille ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q2" value="oui"> oui</label>
                  <label><input type="radio" name="q2" value="parfois"> parfois</label>
                  <label><input type="radio" name="q2" value="non"> non</label>
                </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Avez‐vous des difficultés pour entendre quand quelqu’un parle à voix basse ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q3" value="oui"> oui</label>
                  <label><input type="radio" name="q3" value="parfois"> parfois</label>
                  <label><input type="radio" name="q3" value="non"> non</label>
                </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Vous sentez‐vous handicapé(e) par un problème d’audition ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q4" value="oui"> oui</label>
                  <label><input type="radio" name="q4" value="parfois"> parfois</label>
                  <label><input type="radio" name="q4" value="non"> non</label>
                </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Est-ce qu’un problème d’audition vous met en difficulté lorsque vous rendez visite à des amis, parents,
                voisins ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q5" value="oui"> oui</label>
                  <label><input type="radio" name="q5" value="parfois"> parfois</label>
                  <label><input type="radio" name="q5" value="non"> non</label>
                </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Assistez-vous moins souvent que vous le voudriez à certains évènements (spectacles, concerts, cérémonies
                religieuses) à cause d’un problème d’audition ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q6" value="oui"> oui</label>
                  <label><input type="radio" name="q6" value="parfois"> parfois</label>
                  <label><input type="radio" name="q6" value="non"> non</label>
                </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Est-ce qu’un problème d’audition est à l’origine de disputes avec les membres de votre famille ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q7" value="oui"> oui</label>
                  <label><input type="radio" name="q7" value="parfois"> parfois</label>
                  <label><input type="radio" name="q7" value="non"> non</label>
                </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Est-ce qu’un problème d’audition vous met en difficulté pour écouter la TV ou la radio ?<td>
              <div class="options">
                <label><input type="radio" name="q8" value="oui"> oui</label>
                <label><input type="radio" name="q8" value="parfois"> parfois</label>
                <label><input type="radio" name="q8" value="non"> non</label>
              </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Avez-vous l’impression qu’une quelconque difficulté d’audition limite ou gêne votre vie personnelle ou
                sociale ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q9" value="oui"> oui</label>
                  <label><input type="radio" name="q9" value="parfois"> parfois</label>
                  <label><input type="radio" name="q9" value="non"> non</label>
                </div>
              </td>
            </tr>
            <tr>
              <td class="Question_HHIES">Est-ce qu’un problème d’audition vous met en difficulté lorsque vous êtes au restaurant avec des parents ou
                des amis ?</td>
              <td>
                <div class="options">
                  <label><input type="radio" name="q10" value="oui"> oui</label>
                  <label><input type="radio" name="q10" value="parfois"> parfois</label>
                  <label><input type="radio" name="q10" value="non"> non</label>
                </div>
              </td>
            </tr>

          </tbody>
        </table>

        <div class="buttons-container">
          <button type="button" onclick="calculateScoreHyperacousie()">Calculer le Score</button>
          <button type="reset" onclick="resetFormHyperacousie()">Réinitialiser</button>
        </div>


        <div id="results" style="display:none">
        <p id="scoreDisplay"></p><br>
        <label for="nameID" class="Subject_name">Nom du sujet (si besoin)</label>
        <input type="text" id="ID" name="nameID"><br>
        <button id="savePdfButton" onclick="savePdf()">Exporter en PDF</button>
        <button id="saveXLSbutton" onclick="saveXLS()">Exporter en XLS</button>
      </div>
      </form>

    <script>
      function calculateScoreHyperacousie() {
        let score = 0;
        let allAnswered = true; // Flag to track if all questions have been answered

        for (let i = 1; i <= 10; i++) {
          let q = document.querySelector(`input[name="q${i}"]:checked`);
          if (!q) { // Check if a radio button for the current question is not checked
            allAnswered = false;
            break; // Exit the loop early if a question is unanswered
          }


          let value = q.value;
          if (value === "oui") {
            score += 4;
          } else if (value === "parfois") {
            score += 2;
          } else if (value === "non") {
            score += 0;
          }
        }
        

        if (allAnswered) {
          displayResult(score); // Call your existing function to display the result
        } else {
          // Display a message to the user that not all questions have been answered
          const resultDiv = document.getElementById("results"); // Assuming you have a div with id="result"
          resultDiv.innerHTML = "<p class=Error_message_not_all_answered>Veuillez répondre svp à toutes les questions avant de calculer le score!</p>";
          resultDiv.style.display = "block"; // Make sure the result div is visible
        }

      }
      function displayResult(score) {


        let resultat = "Le score est " + score + " indique " ;

        if (score  <= 8) {
          resultat += "une probabilité de 11% d’avoir une perte auditive";
        } else if (score >= 10 && score <= 16) {
          resultat += "une probabilité de 74,5% d’avoir une perte auditive";
        } else if (score >= 18 && score <= 40) {
          resultat += "une probabilité de 94% d’avoir une perte auditive";
        }

        document.getElementById("results").innerHTML = resultat;
        document.getElementById("results").style.display = "block";
      }

      function resetFormHyperacousie() {
        document.getElementById("HHIE-S").reset();
        document.getElementById("results").innerHTML = "";
        document.getElementById("results").style.display = "none";
      }
    </script>

  </body>
</html>
